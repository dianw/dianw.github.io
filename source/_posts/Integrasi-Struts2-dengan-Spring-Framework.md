title: "Integrasi Struts2 dengan Spring Framework"
date: 2010-08-22 03:13:26
tags:
---

Awal cerita dimulai ketika dahulu kala saat saya membuat sebuah aplikasi berbasis swing dengan koneksi database menggunakan jdbc (purba banget yah...). Sebuah kasus muncul ketika saya harus menginisialisasikan setiap Object <font face="Courier">DataSource</font> di setiap class yang membutuhkan pasokan koneksi ke database. Sebuah teknik yang sangat buruk baik secara penulisan kode yang berulang-ulang dan membuang banyak waktu, lebih buruk lagi pengaruhnya terhadap performa aplikasi karena koneksi ke database merupakan sebuah operasi yang mahal, tidak terbayangkan berapa banyak koneksi yang terjadi hanya untuk membuat satu buah CRUD saja. Singkat cerita setelah cari-cari (curi-curi), disitulah awal mula saya bertemu dengan sebuah istilah yang dinamakan Dependency Injection (DI) dan Inversion of Control (Ioc), nah loh dua buah istilah ternyata :p yaitu sebuah mekanisme dimana sebuah object diinisialisasikan 'sekali' dalam IoC container yang kemudian akan disuntikkan ke setiap class yang membutuhkannya, walaupun saat itu saya masih menggunakan cara manual untuk melakukan injeksi ke setiap class melalui constructor.

Akhir cerita masalah selesai hingga saya meneruskan sebuah project bernama [BlueOxygen Postila](http://sourceforge.net/projects/postila/) (yang ini sudah pakai hibernate loh :D). Weeiiitt jangan pergi dulu, cerita masih belum selesai.

Babak satu tuntas, dan babak selanjutnya pun berjalan, dan memang benar, masalah barupun muncul ketika saya membuat aplikasi berbasis web menggunakan Struts2 sebagai controllernya. Teknik injeksi pada [Postila](http://sourceforge.net/projects/postila/) sama sekali tidak berlaku pada aplikasi web. Dan lagi-lagi saya dipertemukan dengan teknologi yang bernama SpringFramework, sebuah IoC Container yang terpopuler saat itu (mungkin juga sampai saat ini :D).

"Hoaammmm ngantuk, kepanjangan ceritanya!!!" Wehe saya yakin semua yang baca pasti pada ngantuk...

Gak usah panjang lebar (tapi panjang buaaanget :p), saya mau sharing gimana cara melakukan injeksi pada Struts2 dengan menggunakan Spring sebagai IoC containernya. Disini saya mengambil contoh kasus DataSource dimana setiap... @#$@%#$^%$&%!!! Hehehe, kasusnya sama seperti di awal cerita.

Pertama saya menggunakan Struts versi 2.2.1 dan SpringFramework versi 3.0.1.

Berikut beberapa library yang dibutuhkan (belum pake maven :p)

![](http://lh5.ggpht.com/_ea6RQRVsoP4/THA0Hd0zHXI/AAAAAAAAALY/ofEUBFaYH9c/s800/libraries.png)

Kemudian tambahkan baris berikut pada web.xml

<pre style="border-right: #cecece 1px solid; padding-right: 5px; border-top: #cecece 1px solid; padding-left: 5px; min-height: 40px; padding-bottom: 5px; overflow: auto; border-left: #cecece 1px solid; width: 550px; padding-top: 5px; border-bottom: #cecece 1px solid; background-color: #fbfbfb"><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  1: <span style="color: #0000ff">&lt;?</span>xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;<span style="color: #0000ff">?&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  2: <span style="color: #0000ff">&lt;</span><span style="color: #800000">web</span>-<span style="color: #ff0000">app</span> <span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">xsi</span>=<span style="color: #0000ff">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  3: 	<span style="color: #ff0000">xmlns</span>=<span style="color: #0000ff">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> <span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">web</span>=<span style="color: #0000ff">&quot;http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  4: 	<span style="color: #ff0000">xsi</span>:<span style="color: #ff0000">schemaLocation</span>=<span style="color: #0000ff">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  5: 	<span style="color: #ff0000">id</span>=<span style="color: #0000ff">&quot;WebApp_ID&quot;</span> <span style="color: #ff0000">version</span>=<span style="color: #0000ff">&quot;2.5&quot;</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  6: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  7: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">display</span>-<span style="color: #ff0000">name</span><span style="color: #0000ff">&gt;</span>Struts2<span style="color: #0000ff">&lt;/</span><span style="color: #800000">display</span>-name<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  8: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  9: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">filter</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 10: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">filter</span>-<span style="color: #ff0000">name</span><span style="color: #0000ff">&gt;</span>struts2<span style="color: #0000ff">&lt;/</span><span style="color: #800000">filter</span>-name<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 11: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">filter</span>-<span style="color: #ff0000">class</span><span style="color: #0000ff">&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span style="color: #0000ff">&lt;/</span><span style="color: #800000">filter</span>-class<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 12: 	<span style="color: #0000ff">&lt;/</span><span style="color: #800000">filter</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 13: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 14: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">filter</span>-<span style="color: #ff0000">mapping</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 15: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">filter</span>-<span style="color: #ff0000">name</span><span style="color: #0000ff">&gt;</span>struts2<span style="color: #0000ff">&lt;/</span><span style="color: #800000">filter</span>-name<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 16: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">url</span>-<span style="color: #ff0000">pattern</span><span style="color: #0000ff">&gt;</span>/*<span style="color: #0000ff">&lt;/</span><span style="color: #800000">url</span>-pattern<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 17: 	<span style="color: #0000ff">&lt;/</span><span style="color: #800000">filter</span>-mapping<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 18: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 19: 	<span style="color: #008000">&lt;!-- Spring Configuration --&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 20: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">context</span>-<span style="color: #ff0000">param</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 21: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">param</span>-<span style="color: #ff0000">name</span><span style="color: #0000ff">&gt;</span>contextConfigLocation<span style="color: #0000ff">&lt;/</span><span style="color: #800000">param</span>-name<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 22: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">param</span>-<span style="color: #ff0000">value</span><span style="color: #0000ff">&gt;</span>classpath:applicationContext*.xml<span style="color: #0000ff">&lt;/</span><span style="color: #800000">param</span>-value<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 23: 	<span style="color: #0000ff">&lt;/</span><span style="color: #800000">context</span>-param<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #ebebeb"> 24: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 25: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">listener</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 26: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">listener</span>-<span style="color: #ff0000">class</span><span style="color: #0000ff">&gt;</span>org.springframework.web.context.ContextLoaderListener<span style="color: #0000ff">&lt;/</span><span style="color: #800000">listener</span>-class<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 27: 	<span style="color: #0000ff">&lt;/</span><span style="color: #800000">listener</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 28: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 29: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">welcome</span>-<span style="color: #ff0000">file</span>-<span style="color: #ff0000">list</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 30: 		<span style="color: #0000ff">&lt;</span><span style="color: #800000">welcome</span>-<span style="color: #ff0000">file</span><span style="color: #0000ff">&gt;</span>index.jsp<span style="color: #0000ff">&lt;/</span><span style="color: #800000">welcome</span>-file<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 31: 	<span style="color: #0000ff">&lt;/</span><span style="color: #800000">welcome</span>-file-list<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 32: <span style="color: #0000ff">&lt;/</span><span style="color: #800000">web</span>-app<span style="color: #0000ff">&gt;</span></pre></pre>

Berikut konfigurasi jdbc connection pada applicationContext-jdbc yang diletakkan pada classpath. Saya menggunakan MySQL DB.

![](http://lh5.ggpht.com/_ea6RQRVsoP4/THA9v3k9E9I/AAAAAAAAALg/RCbgbUdTGo4/s800/application_context.png) 

<pre style="border-right: #cecece 1px solid; padding-right: 5px; border-top: #cecece 1px solid; padding-left: 5px; min-height: 40px; padding-bottom: 5px; overflow: auto; border-left: #cecece 1px solid; width: 550px; padding-top: 5px; border-bottom: #cecece 1px solid; background-color: #fbfbfb"><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  1: <span style="color: #0000ff">&lt;?</span>xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;<span style="color: #0000ff">?&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  2: <span style="color: #0000ff">&lt;</span><span style="color: #800000">beans</span> <span style="color: #ff0000">xmlns</span>=<span style="color: #0000ff">&quot;http://www.springframework.org/schema/beans&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  3: 	<span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">xsi</span>=<span style="color: #0000ff">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">context</span>=<span style="color: #0000ff">&quot;http://www.springframework.org/schema/context&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  4: 	<span style="color: #ff0000">xmlns</span>:<span style="color: #ff0000">p</span>=<span style="color: #0000ff">&quot;http://www.springframework.org/schema/p&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  5: 	<span style="color: #ff0000">xsi</span>:<span style="color: #ff0000">schemaLocation</span>=<span style="color: #0000ff">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  6: 		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  7: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  8: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">bean</span> <span style="color: #ff0000">id</span>=<span style="color: #0000ff">&quot;dataSource&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  9: 		<span style="color: #ff0000">class</span>=<span style="color: #0000ff">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 10: 		<span style="color: #ff0000">p</span>:<span style="color: #ff0000">driverClassName</span>=<span style="color: #0000ff">&quot;com.mysql.jdbc.Driver&quot;</span> <span style="color: #ff0000">p</span>:<span style="color: #ff0000">username</span>=<span style="color: #0000ff">&quot;root&quot;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 11: 		<span style="color: #ff0000">p</span>:<span style="color: #ff0000">password</span>=<span style="color: #0000ff">&quot;admin&quot;</span> <span style="color: #ff0000">p</span>:<span style="color: #ff0000">url</span>=<span style="color: #0000ff">&quot;jdbc:mysql://localhost:3306/test&quot;</span> <span style="color: #0000ff">/&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 12: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 13: <span style="color: #0000ff">&lt;/</span><span style="color: #800000">beans</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 14: </pre></pre>

Kemudian untuk memudahkan implementasi method buat sebuah interface untuk menerima datasource dari konfigurasi bean.

<pre style="border-right: #cecece 1px solid; padding-right: 5px; border-top: #cecece 1px solid; padding-left: 5px; min-height: 40px; padding-bottom: 5px; overflow: auto; border-left: #cecece 1px solid; width: 550px; padding-top: 5px; border-bottom: #cecece 1px solid; background-color: #fbfbfb"><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  1: <span style="color: #0000ff">package</span> com.mervpolis.dwx.struts2spring.datasource;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  2: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  3: <span style="color: #0000ff">import</span> javax.sql.DataSource;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  4: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  5: <span style="color: #0000ff">public</span> <span style="color: #0000ff">interface</span> DataSourceAware {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  6: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  7: 	<span style="color: #008000">/**
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  8: 	 * Action class yang mengimplementasikan method ini akan secara otomatis
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  9: 	 * ter-inject oleh object yang telah diinisialisasi pada
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 10: 	 * applicationContext-jdbc.xml. Nama method harus sama dengan id pada bean
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 11: 	 * (jika id=&quot;datasource&quot; maka nama method adalah setDatasource()) dengan
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 12: 	 * parameter yang juga harus disesuaikan dengan class pada bean
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 13: 	 * (org.springframework.jdbc.datasource.DriverManagerDataSource merupakan
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 14: 	 * implementasi dari javax.sql.DataSource)
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 15: 	 */</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 16: 	<span style="color: #0000ff">void</span> setDataSource(DataSource dataSource);
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 17: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 18: }
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 19: </pre></pre>

Coding terus, terus coding... Berikut konfigurasi dari struts.xml

<pre style="border-right: #cecece 1px solid; padding-right: 5px; border-top: #cecece 1px solid; padding-left: 5px; min-height: 40px; padding-bottom: 5px; overflow: auto; border-left: #cecece 1px solid; width: 550px; padding-top: 5px; border-bottom: #cecece 1px solid; background-color: #fbfbfb"><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  1: <span style="color: #0000ff">&lt;?</span>xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; <span style="color: #0000ff">?&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  2: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  3: <span style="color: #0000ff">&lt;</span>!DOCTYPE struts PUBLIC
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  4:     &quot;-//Apache Software Foundation//DTD Struts Configuration 2.0//EN&quot;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  5:     &quot;http://struts.apache.org/dtds/struts-2.0.dtd&quot;<span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  6: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  7: <span style="color: #0000ff">&lt;</span><span style="color: #800000">struts</span><span style="color: #0000ff">&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  8: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">constant</span> <span style="color: #ff0000">name</span>=<span style="color: #0000ff">&quot;struts.enable.DynamicMethodInvocation&quot;</span> <span style="color: #ff0000">value</span>=<span style="color: #0000ff">&quot;false&quot;</span> <span style="color: #0000ff">/&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  9: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">constant</span> <span style="color: #ff0000">name</span>=<span style="color: #0000ff">&quot;struts.devMode&quot;</span> <span style="color: #ff0000">value</span>=<span style="color: #0000ff">&quot;false&quot;</span> <span style="color: #0000ff">/&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 10: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">constant</span> <span style="color: #ff0000">name</span>=<span style="color: #0000ff">&quot;struts.convention.action.suffix&quot;</span> <span style="color: #ff0000">value</span>=<span style="color: #0000ff">&quot;Controller&quot;</span> <span style="color: #0000ff">/&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 11: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">constant</span> <span style="color: #ff0000">name</span>=<span style="color: #0000ff">&quot;struts.convention.default.parent.package&quot;</span> <span style="color: #ff0000">value</span>=<span style="color: #0000ff">&quot;struts-default&quot;</span> <span style="color: #0000ff">/&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 12: 	<span style="color: #0000ff">&lt;</span><span style="color: #800000">constant</span> <span style="color: #ff0000">name</span>=<span style="color: #0000ff">&quot;struts.convention.package.locators&quot;</span> <span style="color: #ff0000">value</span>=<span style="color: #0000ff">&quot;action&quot;</span> <span style="color: #0000ff">/&gt;</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 13: <span style="color: #0000ff">&lt;/</span><span style="color: #800000">struts</span><span style="color: #0000ff">&gt;</span></pre></pre>

Terakhir buat Action Classnya...

<pre style="border-right: #cecece 1px solid; padding-right: 5px; border-top: #cecece 1px solid; padding-left: 5px; min-height: 40px; padding-bottom: 5px; overflow: auto; border-left: #cecece 1px solid; width: 550px; padding-top: 5px; border-bottom: #cecece 1px solid; background-color: #fbfbfb"><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  1: <span style="color: #0000ff">package</span> com.mervpolis.dwx.struts2spring.action;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  2: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  3: <span style="color: #0000ff">import</span> java.sql.Connection;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  4: <span style="color: #0000ff">import</span> java.sql.ResultSet;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  5: <span style="color: #0000ff">import</span> java.util.ArrayList;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  6: <span style="color: #0000ff">import</span> java.util.HashMap;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  7: <span style="color: #0000ff">import</span> java.util.List;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  8: <span style="color: #0000ff">import</span> java.util.Map;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  9: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 10: <span style="color: #0000ff">import</span> javax.sql.DataSource;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 11: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 12: <span style="color: #0000ff">import</span> org.apache.struts2.convention.annotation.Action;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 13: <span style="color: #0000ff">import</span> org.apache.struts2.convention.annotation.Result;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 14: <span style="color: #0000ff">import</span> org.apache.struts2.convention.annotation.Results;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 15: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 16: <span style="color: #0000ff">import</span> com.mervpolis.dwx.struts2spring.datasource.DataSourceAware;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 17: <span style="color: #0000ff">import</span> com.opensymphony.xwork2.ActionSupport;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 18: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 19: @Results({ @Result(name = ActionSupport.SUCCESS, type = &quot;<span style="color: #8b0000">velocity</span>&quot;, location = &quot;<span style="color: #8b0000">/view/item/item_list.vm</span>&quot;) })
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 20: <span style="color: #0000ff">public</span> <span style="color: #0000ff">class</span> ItemController <span style="color: #0000ff">extends</span> ActionSupport <span style="color: #0000ff">implements</span> DataSourceAware {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 21: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 22: 	<span style="color: #0000ff">private</span> DataSource dataSource;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 23: 	<span style="color: #0000ff">private</span> List result = <span style="color: #0000ff">new</span> ArrayList();
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 24: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 25: 	@Action(&quot;<span style="color: #8b0000">/item/show</span>&quot;)
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 26: 	<span style="color: #0000ff">public</span> String show() <span style="color: #0000ff">throws</span> Exception {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 27: 		<span style="color: #0000ff">if</span> (dataSource == <span style="color: #0000ff">null</span>) {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 28: 			addActionError(&quot;<span style="color: #8b0000">Gagal menyuntik datasource</span>&quot;);
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 29: 		} <span style="color: #0000ff">else</span> {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 30: 			Connection connection = dataSource.getConnection();
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 31: 			ResultSet resultSet = connection.prepareStatement(
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 32: 					&quot;<span style="color: #8b0000">SELECT * FROM item</span>&quot;).executeQuery();
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 33: 			<span style="color: #0000ff">while</span> (resultSet.next()) {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 34: 				Map data = <span style="color: #0000ff">new</span> HashMap();
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 35: 				data.put(&quot;<span style="color: #8b0000">name</span>&quot;, resultSet.getString(&quot;<span style="color: #8b0000">name</span>&quot;));
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 36: 				data.put(&quot;<span style="color: #8b0000">price</span>&quot;, resultSet.getString(&quot;<span style="color: #8b0000">price</span>&quot;));
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 37: 				result.add(data);
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 38: 			}
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 39: 		}
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 40: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 41: 		<span style="color: #0000ff">return</span> SUCCESS;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 42: 	}
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 43: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 44: 	<span style="color: #0000ff">public</span> List getResult() {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 45: 		<span style="color: #0000ff">return</span> result;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 46: 	}
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 47: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 48: 	<span style="color: #008000">/**
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 49: 	 * Nah method inilah yang nantinya secara otomatis akan disuntik oleh si spring
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 50: 	 */</span>
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 51: 	<span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> setDataSource(DataSource dataSource) {
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 52: 		<span style="color: #0000ff">this</span>.dataSource = dataSource;
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 53: 	}
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 54: }
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9"> 55: </pre></pre>

Eits ternya ada satu lagi yang ketinggalan... Jangan lupa buat viewernya juga... (classpath:/vew/item/item_list.vm)

![](http://lh4.ggpht.com/_ea6RQRVsoP4/THBFkZF2OSI/AAAAAAAAALo/cv7qblNRqos/s800/item_list_dot_vm.png) 

<pre style="border-right: #cecece 1px solid; padding-right: 5px; border-top: #cecece 1px solid; padding-left: 5px; min-height: 40px; padding-bottom: 5px; overflow: auto; border-left: #cecece 1px solid; width: 550px; padding-top: 5px; border-bottom: #cecece 1px solid; background-color: #fbfbfb"><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  1: #foreach($error in $actionErrors)
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  2: 	$error
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  3: #end
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  4: 
</pre><pre style="font-size: 12px; margin: 0em; width: 100%; font-family: consolas,&#39;Courier New&#39;,courier,monospace; background-color: #f9f9f9">  5: $!result</pre></pre>

Dan akhirnya selesai juga :D coba jalankan, mungkin terkesan ajaib dimana&#160; DataSource tiba-tiba telah terinisialisasi dan aplikasipun berjalan seperti pada normalnya dan disinilah menurut saya kecanggihan dari Spring.

![](http://lh6.ggpht.com/_ea6RQRVsoP4/THBHP5huU6I/AAAAAAAAALw/4sE9gzJ2pfQ/s800/screenshoot.png)